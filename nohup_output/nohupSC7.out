masks are: mixed
  0%|          | 0/500000 [00:00<?, ?it/s]using GPU 0-0 for training
[**] create folder SanityChecks/sttn_SanityCheck7
Warnning: There is no trained model found. An initialized model will be used.
Loading model from release_model/sttn_hyper-kvasir-transfer2-TransMask/gen_00009.pth...
Loading model from /home/rdaher/workspace/phd-work/Endo-STTN/release_model/sttn_hyper-kvasir-hoover-modelspec/gen_00013.pth...
using GPU 1-1 for training
/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py:3075: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn("The default behavior for interpolate/upsample with float scale_factor changed "
  0%|          | 0/500000 [00:05<?, ?it/s]
/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py:3075: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn("The default behavior for interpolate/upsample with float scale_factor changed "
Traceback (most recent call last):
  File "train-cycle.py", line 110, in <module>
    mp.spawn(main_worker, nprocs=config['world_size'], args=(config,))
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 247, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 205, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 166, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/home/rdaher/workspace/phd-work/Endo-STTN/train-cycle.py", line 71, in main_worker
    trainer.train()
  File "/home/rdaher/workspace/phd-work/Endo-STTN/core/trainer_cycle.py", line 319, in train
    elif self.config['data_loader']['masking'] =='mixed': self._train_epoch_mixed(pbar)
  File "/home/rdaher/workspace/phd-work/Endo-STTN/core/trainer_cycle.py", line 748, in _train_epoch_mixed
    gen_A_vid_feat_M = self.netD_A(comp_A_img_M)
NameError: name 'comp_A_img_M' is not defined

